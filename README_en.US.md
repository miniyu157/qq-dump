<div align="center">

# QQ DUMP

An ultra-fast NTQQ database key extraction, decryption, and chat history export tool for Android.
Follows the KISS principle and Unix philosophy. Features I/O strategies optimized for mobile flash storage to minimize read/write wear.

[English](./README_en.US.md) | [简体中文](./README.md)

[![License: GPL v3](https://img.shields.io/badge/License-GPLv3-blue.svg)](LICENSE)
![Shell Check](https://img.shields.io/badge/ShellCheck-passing-success)

</div>

## Dependencies

- Root Access
- sqlcipher binary
- python

qq-dump relies on Termux binaries. Run the following in Termux to install dependencies:

```bash
pkg install -y sqlcipher git coreutils python
```

## Installation

Requires a terminal emulator, such as [termux/termux-app](https://github.com/termux/termux-app/releases).

```bash
git clone https://github.com/miniyu157/qq-dump.git ~/.local/bin/qq-dump-bin
```

```bash
ln -s ~/.local/bin/qq-dump-bin/qq-dump ~/.local/bin/qq-dump
```

> If you use a different symlink name, replace `qq-dump` with your custom name in the examples below.

> [!NOTE]
> Ensure `~/.local/bin` is in your `PATH`.

> [!TIP]
> qq-dump attempts to update automatically. To disable updates, create an empty `.dev` file in the root directory.

## Usage

**`dumpkey` - Retrieves account info and keys**

```bash
qq-dump key [--raw]
```

`--raw`: Output machine-readable raw data (for piping).

---

**`dumpdb` - Decrypts databases (requires `./dumpkey`)**

```bash
qq-dump db [--raw] [--use-disk] [path=db_output/]
```

`--raw`: Simplified output (for piping).

`--use-disk`: Use disk for temporary files instead of RAM. Defaults to `/tmp` (tmpfs).

`PATH`: Custom output path. Ensure the directory exists. Defaults to `db_output/`.

> [!TIP]
> For maximum speed, explicitly use `/tmp` as the output directory.

> [!NOTE]
> If `./db_list.txt` exists and is not empty, only the listed databases will be decrypted.
> Defaults are `nt_msg.db` and `profile_info.db` (one filename per line).

---

**`dumpchat` - Exports human-readable chat logs**

```bash
qq-dump chat <OUTDIR>
```

Depends on `./dumpdb` and Python scripts in `chat_export`.
Internally invokes `./dumpdb --raw /tmp`. Intermediate files reside entirely in memory for ultra-fast performance.

QQ DUMP embeds Python scripts from [miniyu157/QQRootFastDecrypt](https://github.com/miniyu157/QQRootFastDecrypt).
I modified the argument parsing, but further optimization is pending.

Although `QQRootFastDecrypt` is archived, its `export_chats.py` is fully functional. Note that it was 100% generated by an LLM, making maintenance difficult.

The signature "KlxPiao" in `chat_export/LICENSE` is my other alias.

---

### Aliases

- db = database
- key = k

## Development & Debugging

Run `./mock` to simulate the Android filesystem environment (requires `proot` and `mksh`).
It maps specific Android directories to `./.mock_env`, e.g.:

- `/data/user/0/com.tencent.mobileqq/...`
- `/sdcard`
- `/tmp`

It also links your local mksh, tricking qq-dump into seeing `/system/bin/sh` (mapped to `/usr/bin/mksh`).
Falls back to bash if mksh is missing, though compatibility is not guaranteed.

## Credits

Decryption algorithm concept derived from [QQBackup/QQDecrypt](https://github.com/QQBackup/QQDecrypt/).

## License

This project is licensed under the **GNU General Public License v3.0 (GPLv3)**.
See the [LICENSE](LICENSE) file for details.

Copyright (C) 2025 Yumeka <miniyu157@163.com>
